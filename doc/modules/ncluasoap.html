<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
   "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<head>
    <title>Reference</title>
    <link rel="stylesheet" href="../luadoc.css" type="text/css" />
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
</head>

<body>
<div id="container">

<div id="product">
	<div id="product_logo"></div>
	<div id="product_name"><big><b></b></big></div>
	<div id="product_description"></div>
</div> <!-- id="product" -->

<div id="main">

<div id="navigation">


<h1>LuaDoc</h1>
<ul>
	
	<li><a href="../index.html">Index</a></li>
	
</ul>


<!-- Module list -->

<h1>Modules</h1>
<ul>

	<li>
		<a href="../modules/base64.html">base64</a>
	</li>

	<li>
		<a href="../modules/http.html">http</a>
	</li>

	<li><strong>ncluasoap</strong></li>
	
	<li>
		<a href="../modules/tcp.html">tcp</a>
	</li>

	<li>
		<a href="../modules/util.html">util</a>
	</li>

</ul>



<!-- File list -->

<h1>Files</h1>
<ul>

	<li>
		<a href="../files/TextField.html">TextField.lua</a>
	</li>

	<li>
		<a href="../files/base64.html">base64.lua</a>
	</li>

	<li>
		<a href="../files/http.html">http.lua</a>
	</li>

	<li>
		<a href="../files/ncluasoap.html">ncluasoap.lua</a>
	</li>

	<li>
		<a href="../files/tcp.html">tcp.lua</a>
	</li>

	<li>
		<a href="../files/util.html">util.lua</a>
	</li>

</ul>






</div><!-- id="navigation" -->

<div id="content">

<h1>Module <code>ncluasoap</code></h1>

<p>Módulo NCLua SOAP v0.5.6.6: Módulo desenvolvido inteiramente em Lua, para acesso a WebServices SOAP em aplicações de TV Digital.<p/> Utiliza o módulo LuaXML, disponível em <a href="http://lua-users.org/wiki/LuaXml">http://lua-users.org/wiki/LuaXml</a>, que foi adaptado para Lua 5.x e adicionado parâmetro parseAttributes ao método xmlParser.parse para indicar se os atributos das tags devem ser processados ou não. <p/> Licença: <a href="http://creativecommons.org/licenses/by-nc-sa/2.5/br/">http://creativecommons.org/licenses/by-nc-sa/2.5/br/</a></p>

<p><b>Author:</b>
<table class="authors_list">

	<tr><td class="name">Manoel Campos da Silva Filho - <a href="http://manoelcampos.com">http://manoelcampos.com</a></td></tr>

</table>
</p>





<h2>Functions</h2>
<table class="function_list">

	<tr>
	<td class="name" nowrap><a href="#call">call</a>&nbsp;(msgTable, callback, soapVersion, port, externalXsd, httpUser, httpPasswd, soapHeaders, boolean)</td>
	<td class="summary">Envia uma requisição SOAP para realizar a chamada de um método remoto vai HTTP </td>
	</tr>

	<tr>
	<td class="name" nowrap><a href="#removeSchema">removeSchema</a>&nbsp;(xmlTable)</td>
	<td class="summary">Remove qualquer elemento que represente informações de definições de tipo da tabela, pois somente os dados é que interessam.</td>
	</tr>

	<tr>
	<td class="name" nowrap><a href="#tableToXml">tableToXml</a>&nbsp;(tb, level, elevateAnonymousSubTables, tableName)</td>
	<td class="summary">Converte uma tabela lua para uma string que representa um trecho de código XML </td>
	</tr>

</table>






<br/>
<br/>



<h2><a name="functions"></a>Functions</h2>
<dl class="function">



<dt><a name="call"></a><strong>call</strong>&nbsp;(msgTable, callback, soapVersion, port, externalXsd, httpUser, httpPasswd, soapHeaders, boolean)</dt>
<dd>
Envia uma requisição SOAP para realizar a chamada de um método remoto vai HTTP


<h3>Parameters</h3>
<ul>
	
	<li>
	  msgTable: Tabela contendo os parâmetros da requisição, devendo ter o seguinte formato:<br/> msgTable = {<br/> &nbsp;&nbsp;&nbsp;address = "URL do serviço (não é o wsdl). Pode-se incluir um número de porta na mesma.",<br/> &nbsp;&nbsp;&nbsp;namespace = "namespace, informado no wsdl",<br/> &nbsp;&nbsp;&nbsp;operationName = "método remoto que deseja-se acessar",<br/> &nbsp;&nbsp;&nbsp;--Parâmetros de entrada. Se não existirem parâmetros de entrada, o campo deve ser omitido<br/> &nbsp;&nbsp;&nbsp;params = {<br/> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;paramName1=value1,<br/> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;paramName2=value2,<br/> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;paramNameN=valueN<br/> &nbsp;&nbsp;&nbsp;}<br/> &nbsp;}<br/>
	</li>
	
	<li>
	  callback: Função de callback a ser executada quando a resposta da requisição for obtida. A mesma deve possuir em sua assinatura, um parâmetro response, que conterá o retorno da chamada da função remota.
	</li>
	
	<li>
	  soapVersion: Versão do protocolo SOAP a ser utilizado. Os valores permitidos são 1.1 e 1.2. Se omitido, será usado 1.2 Alguns WebServices (como os em ASP.NET, de extensão asmx) suportam diferentes versões do SOAP (como 1.1 e 1.2), mas pode ser que isto não seja verdade para todos os serviços. Assim, precisará ser informado qual a versão do protocolo a ser utilizada.
	</li>
	
	<li>
	  port: Porta a ser utilizada para a conexão. O padrão é 80, no caso do valor ser omitido. A porta também pode ser especificada diretamente na URL (campo address do parâmetro msgTable). Se for indicada uma porta lá e aqui no parâmetro port, a porta da url é que será utilizada e a do parâmetro port será ignorada.
	</li>
	
	<li>
	  externalXsd: 
	</li>
	
	<li>
	  httpUser: Nome de usuário para realizar autenticação HTTP, em caso de WS que utilizam tal recurso. Parâmetro Opcional.
	</li>
	
	<li>
	  httpPasswd: Senha para realizar autenticação HTTP, em caso de WS que utilizam tal recurso. Parâmetro Opcional.
	</li>
	
	<li>
	  soapHeaders: 
	</li>
	
	<li>
	  boolean: externalXsd Indica se o Web Service utiliza um arquivo externo (xsd) para as definições de tipos (XML Schema Definition). O formato da requisição SOAP é dependente disto. A maioria dos Web Services construídos, em diversas linguagens, inclui as definições de tipo diretamente no arquivo WSDL. Os Web Services que usam um xsd externo possuem uma tag xsd:import em seu WSDL. Enquanto o NCLua SOAP não descobre automaticamente esta informação, é necessário que a mesma seja informada pelo desenvolvedor que for usar o módulo. Web Services feitos com a ferramenta Netbeans, utilizando a biblioteca JAX-WS (pelo menos em alguma de suas versões) faz uso de um xsd externo. Neste caso, este parâmetro externalXsd deve ser true. O valor padrão do parâmetro é false.
	</li>
	
</ul>








</dd>




<dt><a name="removeSchema"></a><strong>removeSchema</strong>&nbsp;(xmlTable)</dt>
<dd>
Remove qualquer elemento que represente informações de definições de tipo da tabela, pois somente os dados é que interessam.


<h3>Parameters</h3>
<ul>
	
	<li>
	  xmlTable: Table lua gerada a partir de código XML
	</li>
	
</ul>






<h3>Return value:</h3>
Retorna a nova tabela sem as chaves de schema



</dd>




<dt><a name="tableToXml"></a><strong>tableToXml</strong>&nbsp;(tb, level, elevateAnonymousSubTables, tableName)</dt>
<dd>
Converte uma tabela lua para uma string que representa um trecho de código XML


<h3>Parameters</h3>
<ul>
	
	<li>
	  tb: Tabela a ser convertida
	</li>
	
	<li>
	  level: Apenas usado internamente, quando a função é chamada recursivamente, para imprimir espaços e representar os níveis dentro da tabela.
	</li>
	
	<li>
	  elevateAnonymousSubTables: Se igual a true, quando encontrada uma sub-tabela sem nome dentro da tabela (tendo sido definida apenas como {chave1 = valor1, chave2 = valor2, chaveN = valorN} ao invés de nomeSubTabela = {chave1 = valor1, chave2 = valor2, chaveN = valorN}) os elementos da sub-tabela serão consideradas como se estivessem diretamento dentro da tabela a qual a sub-tabela pertence, e não que estejam dentro da sub-tabela. Tais sub-tabelas não tem um nome para a chave, e sim um índice definido automaticamente pelo compilador Lua. O parâmetro é opcional e seu valor default é false. O uso do valor true é útil quando tem-se sub-tabelas contendo apenas um campo, onde colocou-se tal campo dentro da sub-tabela sem nome, apenas para que, ao ser processada a tabela principal, os campos sejam acessados na ordem em que foram definidos, e não em ordem arbitrária definida pela função pairs (usada internamente nesta função). A ordem do processamento dos campos de uma tabela é importante no caso do processamento da tabela de parâmetros a serem passados a um WebService, pois WSs PHP feitos como a biblioteca NuSOAP, não verificam o nome dos parâmetros, e sim a ordem em que são passados. Assim, o comportamento padrão de acesso aos elementos de uma tabela não garante que os campos serão acessados na mesma ordem em que foram definidos, podendo fazer com que sejam passados os valores trocados para o WS sendo acessado.
	</li>
	
	<li>
	  tableName: Nome da variável table sendo passada para a função. Este parâmetro é opcional e seu valor é utilizado apenas quando é passada uma table em formato de um vetor (array) onde só existem índices, não existindo chaves nomeadas (como ocorre em um registro/struct). Assim, para cada posição no vetor, será gerada uma tag com o nome do mesmo, contendo os dados de cada posição. Isto é utilizado quando o método no Web Service a ser chamado possuir um vetor como parâmetro. Logo, se existir um parâmetro, no método do WS, de nome vet e do tipo array, a função tableToXml gerará um código XML como <vet>valor1</vet><vet>valor2</vet><vet>valorN</vet> para passar tal vetor (table lua) ao método do Web Service.
	</li>
	
</ul>






<h3>Return value:</h3>
Retorna a string com as tags XML geradas a partir dos itens da tabela



</dd>


</dl>






</div> <!-- id="content" -->

</div> <!-- id="main" -->

<div id="about">
	<p><a href="http://validator.w3.org/check?uri=referer"><img src="http://www.w3.org/Icons/valid-xhtml10" alt="Valid XHTML 1.0!" height="31" width="88" /></a></p>
</div> <!-- id="about" -->

</div> <!-- id="container" -->	
</body>
</html>
